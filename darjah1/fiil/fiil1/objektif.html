<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الأفعال - لعبة تفاعلية</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body { 
    font-family: 'Amiri', serif; 
    text-align: center; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #2c3e50; 
    min-height: 100vh;
    padding: 20px;
  }
  
  .container { 
    max-width: 800px; 
    margin: auto; 
    padding: 30px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    min-height: 500px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  
  h1 { 
    font-size: 36px; 
    margin-bottom: 30px; 
    color: #667eea;
    font-weight: 700;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  }
  
  h2 {
    font-size: 28px;
    margin-bottom: 25px;
    color: #2c3e50;
    line-height: 1.4;
  }
  
  .hidden { display: none !important; }
  
  input[type="text"] {
    padding: 15px 20px;
    font-size: 18px;
    border: 2px solid #e0e6ed;
    border-radius: 12px;
    width: 300px;
    max-width: 100%;
    margin: 10px;
    font-family: 'Amiri', serif;
    text-align: center;
    transition: all 0.3s ease;
  }
  
  input[type="text"]:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  button {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white; 
    border: none; 
    padding: 15px 30px;
    margin: 10px; 
    font-size: 18px; 
    border-radius: 12px; 
    cursor: pointer;
    font-family: 'Amiri', serif;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
  }
  
  button:hover { 
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  .option { 
    display: block; 
    margin: 15px auto; 
    width: 90%; 
    max-width: 400px;
    padding: 18px 25px;
    font-size: 20px;
    background: #f8f9fa;
    color: #2c3e50;
    border: 2px solid #e9ecef;
    transition: all 0.3s ease;
  }
  
  .option:hover {
    background: #e9ecef;
    border-color: #667eea;
    transform: translateY(-1px);
  }
  
  .correct {
    background: #d4edda !important;
    border-color: #28a745 !important;
    color: #155724 !important;
  }
  
  .wrong {
    background: #f8d7da !important;
    border-color: #dc3545 !important;
    color: #721c24 !important;
  }
  
  .stats {
    display: flex;
    justify-content: space-around;
    margin: 25px 0;
    flex-wrap: wrap;
  }
  
  .stat-item {
    background: #f8f9fa;
    padding: 15px 25px;
    border-radius: 12px;
    margin: 5px;
    border: 2px solid #e9ecef;
    min-width: 120px;
  }
  
  .stat-label {
    font-size: 16px;
    color: #6c757d;
    margin-bottom: 5px;
  }
  
  .stat-value {
    font-size: 24px;
    font-weight: 700;
    color: #667eea;
  }
  
  #leaderboard { 
    margin-top: 30px; 
    text-align: right;
  }
  
  table { 
    width: 100%; 
    border-collapse: collapse; 
    margin-top: 20px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  
  th, td { 
    border: none;
    padding: 15px 20px; 
    text-align: center;
  }
  
  th { 
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    font-weight: 700;
    font-size: 18px;
  }
  
  td {
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
  }
  
  tr:last-child td {
    border-bottom: none;
  }
  
  tr:nth-child(even) td {
    background: #ffffff;
  }
  
  .progress-bar {
    width: 100%;
    height: 8px;
    background: #e9ecef;
    border-radius: 4px;
    margin: 20px 0;
    overflow: hidden;
  }
  
  .progress-fill {
    height: 100%;
    background: linear-gradient(45deg, #667eea, #764ba2);
    width: 0%;
    transition: width 0.3s ease;
  }
  
  .question-counter {
    font-size: 18px;
    color: #6c757d;
    margin-bottom: 20px;
  }
  
  @media (max-width: 768px) {
    .container {
      margin: 10px;
      padding: 20px;
    }
    
    h1 {
      font-size: 28px;
    }
    
    h2 {
      font-size: 22px;
    }
    
    .option {
      width: 95%;
      padding: 15px 20px;
      font-size: 18px;
    }
    
    .stats {
      flex-direction: column;
      align-items: center;
    }
    
    input[type="text"] {
      width: 90%;
    }
  }
</style>
</head>
<body>

<div class="container">

  <!-- شاشة البداية -->
  <div id="startScreen">
    <h1>🎮 لعبة الأفعال التفاعلية</h1>
    <p style="font-size: 20px; margin-bottom: 25px; color: #6c757d;">اختبر معرفتك بالأفعال العربية</p>
    <input type="text" id="playerName" placeholder="اكتب اسمك هنا" maxlength="20">
    <br><br>
    <button onclick="startGame()" style="font-size: 22px; padding: 18px 40px;">🚀 ابدأ اللعبة</button>
  </div>

  <!-- شاشة اللعبة -->
  <div id="gameScreen" class="hidden">
    <div class="question-counter">
      السؤال <span id="currentQ">1</span> من <span id="totalQ">20</span>
    </div>
    
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    
    <h2 id="questionText"></h2>
    <div id="options"></div>
    
    <div class="stats">
      <div class="stat-item">
        <div class="stat-label">⏱️ الوقت</div>
        <div class="stat-value" id="timer">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">🏆 النتيجة</div>
        <div class="stat-value" id="score">0</div>
      </div>
    </div>
  </div>

  <!-- شاشة النهاية -->
  <div id="endScreen" class="hidden">
    <h2>🎉 أحسنت! انتهت اللعبة</h2>
    
    <div class="stats" style="justify-content: center; margin: 30px 0;">
      <div class="stat-item">
        <div class="stat-label">👤 الاسم</div>
        <div class="stat-value" id="finalName"></div>
      </div>
      <div class="stat-item">
        <div class="stat-label">🏆 النتيجة</div>
        <div class="stat-value" id="finalScore"></div>
      </div>
      <div class="stat-item">
        <div class="stat-label">⏱️ الوقت</div>
        <div class="stat-value" id="finalTime"></div>
      </div>
    </div>

    <button onclick="restartGame()" style="margin: 20px;">🔄 العب مرة أخرى</button>

    <div id="leaderboard">
      <h3 style="color: #667eea; font-size: 24px; margin-bottom: 20px;">🏆 لوحة الشرف</h3>
      <table>
        <tr><th>🏅 المرتبة</th><th>👤 الاسم</th><th>🏆 النتيجة</th><th>⏱️ الوقت</th></tr>
        <tbody id="boardContent"></tbody>
      </table>
    </div>
  </div>

</div>

<script>
let allQuestions = [
  {q:"(هُوَ ...) الدرس", options:["يكتب","أكتب","نكتب","تكتبين"], answer:0},
  {q:"(أَنَا ...) التفاح", options:["تأكل","يأكل","آكل","نأكل"], answer:2},
  {q:"(نَحْنُ ...) الكرة", options:["يلعب","ألعب","نلعب","تلعب"], answer:2},
  {q:"(أَنْتِ ...) الماء", options:["تشربين","أشرب","يشرب","نشرب"], answer:0},
  {q:"(هِيَ ...) الكتاب", options:["تقرأ","أقرأ","يقرأ","نقرأ"], answer:0},
  {q:"(أَنْتَ ...) بالقلم", options:["أكتب","تكتب","يكتب","نكتب"], answer:1},
  {q:"(أَنَا ...) إلى المدرسة", options:["أذهب","نذهب","يذهب","تذهب"], answer:0},
  {q:"(نَحْنُ ...) القرآن", options:["يقرأ","نقرأ","أقرأ","تقرأ"], answer:1},
  {q:"(هُوَ ...) على الكرسي", options:["يجلس","تجلس","أجلس","نجلس"], answer:0},
  {q:"(هِيَ ...) إلى السوق", options:["تذهب","يذهب","أذهب","نذهب"], answer:0},
  {q:"(أَنْتَ ...) في الحديقة", options:["ألعب","نلعب","تلعب","يلعب"], answer:2},
  {q:"(أَنْتِ ...) العربية", options:["أدرس","ندرس","تدرسين","يدرس"], answer:2},
  {q:"(أَنَا ...) في البحر", options:["نسبح","يسبح","أسبح","تسبح"], answer:2},
  {q:"(نَحْنُ ...) الدرس", options:["نكتب","يكتب","أكتب","تكتب"], answer:0},
  {q:"(هُوَ ...) الصحيفة", options:["أقرأ","يقرأ","تقرأ","نقرأ"], answer:1},
  {q:"(هِيَ ...) مبكرا", options:["ينام","أنام","تنام","ننام"], answer:2},
  {q:"(أَنْتَ ...) إلى المسجد", options:["تذهب","أذهب","نذهب","يذهب"], answer:0},
  {q:"(أَنْتِ ...) الواجب", options:["أكتب","تكتبين","يكتب","نكتب"], answer:1},
  {q:"(أَنَا ...) اللبن", options:["أشرب","يشرب","نشرب","تشرب"], answer:0},
  {q:"(نَحْنُ ...) معا", options:["يلعب","ألعب","تلعب","نلعب"], answer:3},
  {q:"(هُوَ ...) الدرس", options:["يسمع","أسمع","نسمع","تسمع"], answer:0},
  {q:"(هِيَ ...) الفاكهة", options:["أأكل","تأكل","يأكل","نأكل"], answer:1},
  {q:"(أَنْتَ ...) القصة", options:["أقرأ","نقرأ","يقرأ","تقرأ"], answer:3},
  {q:"(أَنْتِ ...) في الفصل", options:["أجلس","يجلس","تجلسين","نجلس"], answer:2}
];

let currentQuestions = [];
let currentQuestionIndex = 0;
let score = 0;
let startTime = 0;
let timerInterval;
let playerName = "";
let totalQuestions = 10;

function shuffleArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function startGame() {
  playerName = document.getElementById('playerName').value.trim();
  if (!playerName) {
    alert('يرجى إدخال اسمك أولاً');
    return;
  }
  
  // اختيار أسئلة عشوائية
  currentQuestions = shuffleArray(allQuestions).slice(0, totalQuestions);
  currentQuestionIndex = 0;
  score = 0;
  startTime = Date.now();
  
  document.getElementById('startScreen').classList.add('hidden');
  document.getElementById('gameScreen').classList.remove('hidden');
  document.getElementById('totalQ').textContent = totalQuestions;
  
  startTimer();
  showQuestion();
}

function startTimer() {
  timerInterval = setInterval(() => {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    document.getElementById('timer').textContent = elapsed + ' ث';
  }, 1000);
}

function showQuestion() {
  if (currentQuestionIndex >= currentQuestions.length) {
    endGame();
    return;
  }
  
  const question = currentQuestions[currentQuestionIndex];
  document.getElementById('questionText').textContent = question.q;
  document.getElementById('currentQ').textContent = currentQuestionIndex + 1;
  
  // تحديث شريط التقدم
  const progress = ((currentQuestionIndex) / totalQuestions) * 100;
  document.getElementById('progressFill').style.width = progress + '%';
  
  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = '';
  
  question.options.forEach((option, index) => {
    const button = document.createElement('button');
    button.textContent = option;
    button.className = 'option';
    button.onclick = () => selectAnswer(index);
    optionsDiv.appendChild(button);
  });
}

function selectAnswer(selectedIndex) {
  const question = currentQuestions[currentQuestionIndex];
  const buttons = document.querySelectorAll('.option');
  
  // تعطيل جميع الأزرار
  buttons.forEach(btn => btn.disabled = true);
  
  if (selectedIndex === question.answer) {
    buttons[selectedIndex].classList.add('correct');
    score++;
    document.getElementById('score').textContent = score;
  } else {
    buttons[selectedIndex].classList.add('wrong');
    buttons[question.answer].classList.add('correct');
  }
  
  setTimeout(() => {
    currentQuestionIndex++;
    showQuestion();
  }, 1500);
}

function endGame() {
  clearInterval(timerInterval);
  const totalTime = Math.floor((Date.now() - startTime) / 1000);
  
  document.getElementById('gameScreen').classList.add('hidden');
  document.getElementById('endScreen').classList.remove('hidden');
  
  document.getElementById('finalName').textContent = playerName;
  document.getElementById('finalScore').textContent = score + ' / ' + totalQuestions;
  document.getElementById('finalTime').textContent = totalTime + ' ثانية';
  
  saveScore(playerName, score, totalTime);
  updateLeaderboard();
}

function saveScore(name, score, time) {
  let scores = JSON.parse(localStorage.getItem('arabicVerbScores') || '[]');
  scores.push({name, score, time, date: new Date().toLocaleDateString('ar')});
  scores.sort((a, b) => {
    if (b.score !== a.score) return b.score - a.score;
    return a.time - b.time;
  });
  scores = scores.slice(0, 10); // الاحتفاظ بأفضل 10 نتائج
  localStorage.setItem('arabicVerbScores', JSON.stringify(scores));
}

function updateLeaderboard() {
  const scores = JSON.parse(localStorage.getItem('arabicVerbScores') || '[]');
  const tbody = document.getElementById('boardContent');
  tbody.innerHTML = '';
  
  scores.forEach((score, index) => {
    const row = tbody.insertRow();
    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${score.name}</td>
      <td>${score.score}/${totalQuestions}</td>
      <td>${score.time} ث</td>
    `;
  });
  
  if (scores.length === 0) {
    const row = tbody.insertRow();
    row.innerHTML = '<td colspan="4" style="color: #6c757d; font-style: italic;">لا توجد نتائج بعد</td>';
  }
}

function restartGame() {
  document.getElementById('endScreen').classList.add('hidden');
  document.getElementById('startScreen').classList.remove('hidden');
  document.getElementById('playerName').value = playerName;
}

// تحميل لوحة الشرف عند بدء الصفحة
window.onload = function() {
  updateLeaderboard();
}
</script>

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9716be3c45a0b15c',t:'MTc1NTU3NjAxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
